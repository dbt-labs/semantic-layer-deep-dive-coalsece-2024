semantic_models:
  - name: customers
    description: cusomter report book, gran i s cust row
    model: ref('customers')
    defaults: 
      agg_time_dimension: first_ordered_at
    entities:
      - name: customer
        type: primary
        expr: customer_id
    dimensions:
      - name: customer_name
        type: categorical
      - name: cutstmer_type
        type: categorical
      - name: first_ordered_at
        type: time
        type_params:
            time_granularity: day
      - name: last_ordered_at
        type: time
        type_params:
            time_granularity: day 
    measures:
      - name: customers
        description: count of our unique customers
        agg: count_distinct
        expr: customer_name
      - name: count_lifetime_orders
        description: total count of orders per customer
        agg: sum
      - name: lifetime_spend_pretax
        description: customer lifetime spend before taxes
        agg: sum
      - name: lifetime_spend
        description: Gross Customer lifetime apend inclusive of ..
        agg: sum
metrics: 
  # Simple type metrics
  - name: "customers"
    description: "Sum of cusotoemr"
    type: simple
    label: "customer count"
    type_params:
      measure:
        name: customers
  - name: "count_lifetime_orders"
    description: "number of lifetime orders"
    type: simple
    label: "count lifetime order"
    type_params:
      measure:
        name: count_lifetime_orders
#  - name: large_orders
#    description: "Count of orders with order total over 20."
#    type: simple
#    label: "Large Orders"
#    type_params:
#      measure:
#        name: order_count
#    filter: |
#      {{ Metric('order_total', group_by=['order_id']) }} >=  20
  # Ratio type metric
#  - name: "avg_order_value"
#    label: "avg_order_value"
#    description: "average value of each order"
#    type: ratio
#    type_params:
#      numerator: order_total
#      denominator: order_count
  # Cumulative type metrics
#  - name: "cumulative_order_amount_mtd"
#    label: "cumulative_order_amount_mtd"
#    description: "The month to date value of all orders"
#    type: cumulative
#    type_params:
#      measure:
#        name: order_total
#      grain_to_date: month
  # Derived metric
#  - name: "pct_of_orders_that_are_large"
#    label: "pct_of_orders_that_are_large"
#    description: "percent of orders that are large"
#    type: derived
#    type_params:
#      expr: large_orders/order_count
#      metrics:
#        - name: large_orders
#        - name: order_count


      